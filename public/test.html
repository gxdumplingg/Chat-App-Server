<!DOCTYPE html>
<html>

    <head>
        <title>Test Socket.IO</title>
        <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    </head>

    <body>
        <h2>Conversation Realtime Test</h2>
        <div id="messages"></div>

        <script>
            // Kết nối tới server
            const socket = io('http://localhost:3000', {
                auth: {
                    token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2ODNkYjYyOTE0MGVhMDNlOWI5OTEyNDciLCJpYXQiOjE3NDg4NzQ4MzYsImV4cCI6MTc0ODk2MTIzNn0.YGY9J0RXKHjUw529LujNnMij24qPY70QJEfnyAfddLI' // Thay thế bằng token của bạn
                }
            });

            // Lắng nghe các sự kiện
            socket.on('connect', () => {
                console.log('Connected to server');
                addMessage('Connected to server');
            });

            socket.on('conversationsUpdated', (conversations) => {
                console.log('Conversations updated:', conversations);
                addMessage('Conversations updated: ' + JSON.stringify(conversations));
            });

            socket.on('newConversation', (conversation) => {
                console.log('New conversation:', conversation);
                addMessage('New conversation: ' + JSON.stringify(conversation));
            });

            socket.on('conversationUpdated', (conversation) => {
                console.log('Conversation updated:', conversation);
                addMessage('Conversation updated: ' + JSON.stringify(conversation));
            });

            socket.on('conversationDeleted', (conversationId) => {
                console.log('Conversation deleted:', conversationId);
                addMessage('Conversation deleted: ' + conversationId);
            });

            socket.on('addedToConversation', (conversation) => {
                console.log('Added to conversation:', conversation);
                addMessage('Added to conversation: ' + JSON.stringify(conversation));
            });

            socket.on('removedFromConversation', (conversationId) => {
                console.log('Removed from conversation:', conversationId);
                addMessage('Removed from conversation: ' + conversationId);
            });

            function addMessage(message) {
                const div = document.createElement('div');
                div.textContent = message;
                document.getElementById('messages').appendChild(div);
            }
        </script>
    </body>

</html>